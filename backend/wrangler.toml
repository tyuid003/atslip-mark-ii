name = "atslip-backend"
main = "src/index.ts"
compatibility_date = "2024-01-01"

# D1 Database
[[d1_databases]]
binding = "DB"
database_name = "atslip_db"
database_id = "5638e087-63c2-4fb6-95ad-66c864fdfa95"

# KV for Bank Accounts Cache
[[kv_namespaces]]
binding = "BANK_KV"
id = "4bdbda645df643df91bd042bd176b24d"

# Durable Objects for Real-Time Notifications
[[durable_objects.bindings]]
name = "PENDING_NOTIFICATIONS"
class_name = "PendingNotificationsDO"

# Migration for Durable Objects (required for first deployment)
[[migrations]]
tag = "v1"
new_classes = ["PendingNotificationsDO"]

[env.production]
routes = [
  { pattern = "*.atslip.app/api/*", zone_name = "atslip.app" }
]

# Scheduled Jobs (Cron)
[triggers]
crons = ["*/30 * * * *"]  # ทุก 30 นาที

# Environment Variables (set via Cloudflare dashboard or wrangler secret)
# EASYSLIP_API_KEY = "your-easyslip-key"
